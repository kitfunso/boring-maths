---
/**
 * AdCard Component
 *
 * In-feed ad unit styled to match calculator cards on the homepage.
 * Blends seamlessly into the calculator grid.
 *
 * Shows placeholder in dev mode, real ads in production.
 * Requires PUBLIC_ADSENSE_ID environment variable for production ads.
 */

export interface Props {
  adSlot: string;
  className?: string;
}

const { adSlot, className = '' } = Astro.props;

const isProd = import.meta.env.PROD;
const clientId = import.meta.env.PUBLIC_ADSENSE_ID || 'ca-pub-8014911033000505';
const hasAdsense = true;
---

<div class={`ad-card bento-card ${className}`} data-ad-slot={adSlot}>
  {
    isProd && hasAdsense ? (
      <>
        <ins
          class="adsbygoogle"
          style="display:block; min-height: 100px; width: 100%;"
          data-ad-client={clientId}
          data-ad-slot={adSlot}
          data-ad-format="rectangle"
          data-full-width-responsive="false"
        />
      </>
    ) : (
      <div class="ad-placeholder">
        <div class="ad-placeholder-icon">
          <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"
            />
          </svg>
        </div>
        <p class="ad-placeholder-label">Sponsored</p>
        {!isProd && <p class="ad-placeholder-slot">(Ad slot: {adSlot})</p>}
        {isProd && !hasAdsense && <p class="ad-placeholder-slot">(AdSense not configured)</p>}
      </div>
    )
  }
</div>

<style>
  .ad-card {
    min-height: 140px;
    max-height: 280px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--gradient-card);
    overflow: hidden;
  }

  /* Ensure hidden class overrides display:flex */
  .ad-card.hidden {
    display: none !important;
  }

  .ad-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    min-height: 100px;
    text-align: center;
    padding: 0.75rem;
  }

  .ad-placeholder-icon {
    width: 2.5rem;
    height: 2.5rem;
    border-radius: 0.75rem;
    background: linear-gradient(to bottom right, #f59e0b, #ea580c);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 0.75rem;
  }

  .ad-placeholder-label {
    font-size: 0.875rem;
    color: var(--color-muted);
  }

  .ad-placeholder-slot {
    font-size: 0.75rem;
    color: var(--color-muted);
    margin-top: 0.25rem;
    opacity: 0.7;
  }

  .ad-card .adsbygoogle {
    background: transparent;
  }
</style>
